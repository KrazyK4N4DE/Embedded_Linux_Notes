# 计网基础

三要素：**源、目的地、方向**。

源：用IP、端口表示。
目的地：用IP、端口表示。

比如同一电脑两个浏览器访问同一网站，源IP相同，服务器根据源端口不同来区分。  
两个软件(如ssh和浏览器)访问同一网站，目的地IP相同，通过目的端口区分。

---

## 局域网和公网

### 局域网访问公网

局域网要访问公网，要通过路由器，只有路由器才有公网IP。  
![20230505200244](https://image-hosting-1313474851.cos.ap-shanghai.myqcloud.com/Notes/20230505200244.png)

步骤：

1. 局域网访问公网请求发给路由器。
2. 路由器记录需求。
3. 路由器帮忙转发(构造出新的源，而目的地不变)。
4. 目的地收到请求后，返回数据。
5. 数据到达路由器后，会根据之前的记录，帮忙转发回最开始的源。

路由器的作用：

- 数据转发。
- 保护。屏蔽不请自来的数据，如病毒，路由器里并未记录有需求。

### 设备之间访问

两个不同局域网下的设备，没法直接访问，各自的路由器也由于保护作用屏蔽掉外来的数据。  
![20230505201400](https://image-hosting-1313474851.cos.ap-shanghai.myqcloud.com/Notes/20230505201400.png)

怎么办？中间放入服务器。  
![20230505201709](https://image-hosting-1313474851.cos.ap-shanghai.myqcloud.com/Notes/20230505201709.png)

步骤：

1. 开发板和手机建立与服务器的连接。
2. 手机把数据发给服务器。
3. 服务器转发给开发板。

使用MQTT协议，适合用来传输较小的数据，适合物联网。
